def reassign_match_targets(session, base_url, config_id, version, old_policy_id, new_policy_id, fqdn_list, is_prod, section, access_group):
    url = f"{base_url}/appsec/v1/configs/{config_id}/versions/{version}/match-targets"
    response = session.get(url)
    response.raise_for_status()
    match_targets = response.json().get("matchTargets", [])

    summary = {
        "processed": 0,
        "successful": 0,
        "failed": 0,
        "details": []
    }

    for mt in match_targets:
        if mt.get("securityPolicy", {}).get("policyId") != old_policy_id:
            continue

        match_target_id = mt["id"]
        hostname_list = mt.get("hostnames", [])
        file_paths = mt.get("filePaths", [])
        match_criteria = mt.get("matchCriteria", {})
        network_lists = mt.get("bypassNetworkLists", [])

        updated_payload = {
            "securityPolicy": {
                "policyId": new_policy_id
            },
            "hostnames": hostname_list,
            "filePaths": file_paths,
            "matchCriteria": match_criteria,
            "bypassNetworkLists": network_lists
        }

        try:
            patch_url = f"{url}/{match_target_id}"
            patch_response = session.put(patch_url, json=updated_payload)
            patch_response.raise_for_status()
            summary["processed"] += 1
            summary["successful"] += 1
            summary["details"].append({
                "id": match_target_id,
                "name": hostname_list,
                "status": "success"
            })
            print(f"[INFO] Reassigned match target {match_target_id} to policy {new_policy_id}")
        except Exception as e:
            summary["processed"] += 1
            summary["failed"] += 1
            summary["details"].append({
                "id": match_target_id,
                "name": hostname_list,
                "status": "failed",
                "error": str(e)
            })
            print(f"[ERROR] Failed to reassign match target {match_target_id}: {e}")

    return summary
