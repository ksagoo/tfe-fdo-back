def find_client_list_by_name(session, base_url, name_substring, return_first=False):
    """
    Finds AppSec Client Lists matching the given name substring (case-insensitive).
    Returns full client list object(s) with 'name' and 'id'.
    """
    url = urljoin(base_url, "/appsec/v1/client-lists")
    resp = session.get(url)

    if not resp.ok:
        raise Exception(f"Failed to retrieve client lists: {resp.status_code} - {resp.text}")

    results = []
    for cl in resp.json():
        name = cl.get("name", "")
        cl_id = cl.get("id")
        if name_substring.lower() in name.lower():
            print(f"[MATCH] {name} â†’ ID: {cl_id}")
            results.append({"name": name, "id": cl_id})
            if return_first:
                return results[0]

    if not results:
        print(f"[INFO] No client lists matched '{name_substring}'")
    return results[0] if return_first and results else results

