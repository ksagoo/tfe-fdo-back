

def delete_policy(session, base_url, config_id, policy_id):
    url = urljoin(base_url, f"/appsec/v1/configs/{config_id}/security-policies/{policy_id}")
    print(f"\n Deleting old TEMP policy {policy_id}...")
    response = session.delete(url)

    if response.status_code == 204:
        print("TEMP policy deleted successfully.")
        return True
    else:
        print(f" Failed to delete TEMP policy: {response.status_code} - {response.text}")
        return False

    delete_policy(session, base_url, new_config_id, temp_policy_id)
