def build_cloned_list_id_map(session, base_url, access_group_prefix):
    url = f"{base_url}/client-list/v1/lists"
    response = session.get(url)
    response.raise_for_status()

    lists = response.json().get("listItems", [])
    id_map = {}

    name_to_id = {lst["name"]: lst["uniqueId"] for lst in lists if "name" in lst and "uniqueId" in lst}

    for name, template_id in name_to_id.items():
        if name.startswith("Security Policy Template"):
            suffix = name.replace("Security Policy Template ", "").strip()
            clone_name = f"SC-{access_group_prefix} {suffix}"
            if clone_name in name_to_id:
                id_map[template_id] = name_to_id[clone_name]

    return id_map
