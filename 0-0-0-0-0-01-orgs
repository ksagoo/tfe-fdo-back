 Module 2: Reassign Client Lists (Fixed - Bulk PUT)
def reassign_client_lists(session, base_url, config_id, version, temp_policy_id, new_policy_id):
    url = f"{base_url}/appsec/v1/configs/{config_id}/versions/{version}/security-policies/{temp_policy_id}/client-list-activations"
    response = session.get(url)
    response.raise_for_status()
    client_lists = response.json().get("clientLists", [])

    results = {"processed": 0, "successful": 0, "failed": 0, "details": []}
    if not client_lists:
        print("[INFO] No client lists to reassign.")
        return results

    for clist in client_lists:
        clist["policyId"] = new_policy_id

    put_url = f"{base_url}/appsec/v1/configs/{config_id}/versions/{version}/security-policies/{new_policy_id}/client-list-activations"
    try:
        session.put(put_url, json={"clientLists": client_lists})
        results["processed"] = len(client_lists)
        results["successful"] = len(client_lists)
        for cl in client_lists:
            results["details"].append({"id": cl.get("id"), "status": "success"})
        print(f"[INFO] Reassigned {len(client_lists)} client lists to new policy.")
    except Exception as e:
        results["processed"] = len(client_lists)
        results["failed"] = len(client_lists)
        results["details"].append({"status": "failed", "error": str(e)})
        print(f"[ERROR] Failed to update client list activations: {e}")

    return results
