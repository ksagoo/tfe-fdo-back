

def domain_exists_nslookup(domain):
    """
    Uses nslookup to check if the domain resolves.
    Returns True if nslookup returns a valid response,
    or False if it indicates the domain doesn't exist.
    """
    try:
        result = subprocess.check_output(["nslookup", domain], universal_newlines=True)
        # If nslookup finds no address, the output will include phrases like "Non-existent domain"
        if "Non-existent domain" in result or "can't find" in result.lower():
            print(f"[nslookup] {domain} did not resolve.")
            return False
        print(f"[nslookup] {domain} resolved successfully.")
        return True
    except Exception as e:
        print(f"Error running nslookup: {e}")
        return False

def domain_exists_nslookup(domain):
    """
    Uses nslookup to check if the domain resolves.
    Returns True if nslookup returns a valid response,
    or False if it indicates the domain doesn't exist.
    """
    try:
        result = subprocess.check_output(["nslookup", domain], universal_newlines=True)
        # If nslookup finds no address, the output will include phrases like "Non-existent domain"
        if "Non-existent domain" in result or "can't find" in result.lower():
            print(f"[nslookup] {domain} did not resolve.")
            return False
        print(f"[nslookup] {domain} resolved successfully.")
        return True
    except Exception as e:
        print(f"Error running nslookup: {e}")
        return False


    if not can_create_enrollment(session, base_url, contract_id, common_name):
        print("Cannot create enrollment; aborting.")
        sys.exit(1)
    else:
        print("All checks passed; you can proceed to create the enrollment.")
