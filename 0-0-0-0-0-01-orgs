{
  "securityPolicyId": "{{ target.policy_id }}",
  "type": {
    "matchType": "hostname"
  },
  "sequence": 0,
  "useHeaders": [],
  "isNegativeFileExtensionMatch": {{ target.is_negative_file_extension_match | default(false) | lower }},
  "isSharedWAFMatch": false,
  "fileExtensions": [
    {% for ext in target.file_extensions %}
    "{{ ext }}"{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "hostnames": [
    {% for h in target.hostnames %}
    "{{ h }}"{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "pathMatchType": "PREFIXED",
  "matches": [
    {
      "matchOperator": "IS_ONE_OF",
      "values": [
        {% for p in target.paths %}
        "{{ p }}"{% if not loop.last %},{% endif %}
        {% endfor %}
      ]
    }
  ]
}
