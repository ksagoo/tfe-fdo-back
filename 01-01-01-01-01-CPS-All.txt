match_targets:
  - configId: 123456
    configVersion: 1
    targetId: 987654
    defaultFile: "NO_MATCH"
    filePaths: ["/"]
    hostnames: ["dummy-apac-cn.hostname"]
    isNegativeFileExtensionMatch: false
    isSharedAliasMatch: false
    securityPolicy:
      policyId: "TEMP_285595"
    sequence: 1
    effectiveSecurityControls:
      applyApiConstraintControls: true
      applyApplicationLayerControls: true
      applyBotmanControls: true
      applyNetworkLayerControls: true
      applyRateControls: true
      applyReputationControls: true
      applySlowPostControls: true
      applyIpProtectionControls: false
    bypassNetworkLists:
      - id: "123456_SECURITYBYPASSLIST"
        listType: "CL"
        name: "Template Security Bypass List"
        type: "IP"


rendered = render_template(env, "match_targets_full_template.j2", {"match_targets": your_targets})

[
{% for target in match_targets %}
{
  "configId": {{ target.configId }},
  "configVersion": {{ target.configVersion }},
  "targetId": {{ target.targetId }},
  "sequence": {{ target.sequence }},
  "type": "{{ target.type }}",
  "bypassNetworkLists": [
    {% for bnl in target.bypassNetworkLists %}
    {
      "id": "{{ bnl.id }}",
      "listType": "{{ bnl.listType }}",
      "name": "{{ bnl.name }}",
      "type": "{{ bnl.type }}"
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "defaultFile": "{{ target.defaultFile }}",
  "effectiveSecurityControls": {
    "applyApplicationLayerControls": {{ target.effectiveSecurityControls.applyApplicationLayerControls | lower }},
    "applyBotmanControls": {{ target.effectiveSecurityControls.applyBotmanControls | lower }},
    "applyNetworkLayerControls": {{ target.effectiveSecurityControls.applyNetworkLayerControls | lower }},
    "applyRateControls": {{ target.effectiveSecurityControls.applyRateControls | lower }},
    "applyReputationControls": {{ target.effectiveSecurityControls.applyReputationControls | lower }},
    "applySlowPostControls": {{ target.effectiveSecurityControls.applySlowPostControls | lower }},
    "applyApiProtectionControls": {{ target.effectiveSecurityControls.applyApiProtectionControls | lower }},
    "applyAccountProtectionControls": {{ target.effectiveSecurityControls.applyAccountProtectionControls | lower }}
  },
  "filePaths": [
    {% for path in target.filePaths %}
    "{{ path }}"{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "hostnames": [
    {% for host in target.hostnames %}
    "{{ host }}"{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "isNegativeFileExtensionMatch": {{ target.isNegativeFileExtensionMatch | lower }},
  "isSharedAliasMatch": {{ target.isSharedAliasMatch | lower }},
  "securityPolicy": {
    "policyId": "{{ target.securityPolicy.policyId }}"
  },
  "apiTargets": []
}
{% if not loop.last %},{% endif %}
{% endfor %}
]
