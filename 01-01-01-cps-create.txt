# --- inside reverse_fqdn_lookup() ---
if fqdn.lower() in (cname_from, cname_to, edge_hostname):
    group_id = entry.get("groupId")
    property_name = entry.get("propertyName", "UNKNOWN")

    # Get group name
    access_group_name = get_group_name_by_id(session, base_url, group_id)

    # Clean property name
    stripped_name = property_name
    if stripped_name.startswith("SD-"):
        stripped_name = stripped_name[3:]
    for suffix in ["-Non-Prod", "-NonProd", "-Prod"]:
        if stripped_name.endswith(suffix):
            stripped_name = stripped_name[: -len(suffix)]

    # Compare stripped property name vs access group
    match_access_group = stripped_name.lower() == access_group_name.lower()

    # Collect results
    result.update({
        "groupId": group_id,
        "propertyName": property_name,
        "accessGroupName": access_group_name,
        "strippedPropertyName": stripped_name,
        "matchesAccessGroup": match_access_group
    })

    print("\n=== Reverse FQDN Lookup Result ===")
    print(f"[INFO] FQDN: {fqdn}")
    print(f"[INFO] Group ID: {group_id}")
    print(f"[INFO] Access Group: {access_group_name}")
    print(f"[INFO] Property Name: {property_name}")
    print(f"[INFO] Stripped Property Name: {stripped_name}")
    print(f"[INFO] Property â†” AccessGroup Match: {match_access_group}")
    print("==================================\n")
    break
