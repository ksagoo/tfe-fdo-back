# Full FQDN Lookup
if args.all_fqdns:
    fqdns = get_all_fqdns(session, base_url, debug=args.debug)
    print(f"\n[INFO] Running reverse lookup for {len(fqdns)} FQDNs...\n")

    for fqdn_item in sorted(fqdns):
        print(f"\n[INFO] → Reverse lookup for {fqdn_item}")
        reverse_fqdn_lookup(session, base_url, fqdn_item, debug=args.debug)

    print(f"\n[INFO] Retrieved {len(fqdns)} total FQDNs from Akamai PAPI.")
    print("[INFO] All reverse lookups complete.\n")

    # Only stop here if explicitly in debug mode
    if args.debug:
        print("[INFO] Debug mode enabled — stopping after all-fqdns run.\n")
        return
